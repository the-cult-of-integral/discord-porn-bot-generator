"""
Bot generated by the-cult-of-integral
https://github.com/the-cult-of-integral/discord-porn-bot-generator
"""

import logging

import discord
from databases import Databases
from discord.ext import commands

logging.basicConfig(level=logging.INFO, format='%(asctime)s - %(name)s - %(levelname)s - %(message)s',
                    datefmt='%d-%b-%y %H:%M:%S', filename='LOG.log', filemode='w')


class Config(commands.Cog):
    def __init__(self, bot) -> None:
        """
        Constructor
        """
        self.bot = bot
        self.db = Databases()
        return

    @commands.command()
    @commands.has_permissions(administrator=True)
    async def config(self, ctx, cfgk, cfgv) -> None:
        """
        Update config
        """
        if cfgv is None:
            embed = discord.Embed(
                title='Incorrect Syntax',
                description='The correct syntax for this command is `s!config <cfgk> <cfgv>`',
                color=discord.Colour.orange())
            await ctx.send(embed=embed)
        else:
            cfgv = int(cfgv)
            if self.db.update_config(cfgk, cfgv, ctx.guild.id):
                embed = discord.Embed(title='Config Updated',
                                      color=discord.Colour.green())
                await ctx.send(embed=embed)
            else:
                embed = discord.Embed(title='Config failed to update',
                                      color=discord.Colour.red())
                await ctx.send(embed=embed)
        return

    def __del__(self) -> None:
        """
        Destructor
        """
        del self.db
        return


def setup(bot) -> None:
    bot.add_cog(Config(bot))
    return
